Improvces functionality of feature2 branch
